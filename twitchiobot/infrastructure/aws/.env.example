# ============================================================
# ViewerAtlas — AWS Deployment Environment Variables
# ============================================================
# Copy this file to .env and fill in the values before deploying.
#   cp .env.example .env
#
# These variables are consumed by:
#   - deploy.sh / safe-deploy.sh  (build & push images, register tasks)
#   - docker-compose.yml          (local dev with docker-compose)
#   - ECS task definitions         (via sed placeholder replacement)
# ============================================================

# ── AWS Account & Region ────────────────────────────────────
AWS_REGION=us-east-1
# AWS_ACCOUNT_ID is auto-detected from `aws sts get-caller-identity`

# ── S3 Data Lake ────────────────────────────────────────────
# REQUIRED.  Unique bucket name for all ViewerAtlas data.
S3_BUCKET=vieweratlas-data-lake
S3_PREFIX=vieweratlas/

# ── ECS ─────────────────────────────────────────────────────
ECS_CLUSTER=vieweratlas-cluster
ASSIGN_PUBLIC_IP=ENABLED

# ── EFS (Optional) ──────────────────────────────────────────
# EFS is OPTIONAL. It's referenced in ecs-task-collector.json and
# ecs-task-vod-collector.json for mounting channels.txt / vod_queue.json.
# If you bake channels.txt into the Docker image (the default) and
# store vod_queue.json in S3, you can leave EFS_ID blank and remove
# the volumes/mountPoints sections from the task definitions.
# EFS_ID=fs-xxxxxxxxx

# ── Twitch Credentials ─────────────────────────────────────
# For LOCAL / docker-compose usage only.
# On ECS these are injected from AWS Secrets Manager (see DEPLOYMENT.md).
TWITCH_OAUTH_TOKEN=
TWITCH_CLIENT_ID=

# ── Storage Backend ─────────────────────────────────────────
# 'file' for local development, 's3' for AWS deployment.
STORAGE_TYPE=file
# S3_REGION is the same as AWS_REGION by default.

# ── Docker Build ────────────────────────────────────────────
# Pin TwitchDownloaderCLI version for reproducible VOD container builds.
# See: https://github.com/lay295/TwitchDownloader/releases
TWITCH_DOWNLOADER_VERSION=1.55.0

# ── Alerts ──────────────────────────────────────────────────
# Email address for AWS Budget and SNS alarm notifications.
ALERT_EMAIL=

# ── Networking (ECS tasks) ──────────────────────────────────
# Replace with your VPC subnet and security group IDs.
# Required for EventBridge → ECS scheduled tasks.
# SUBNET_IDS=subnet-xxxxx,subnet-yyyyy
# SECURITY_GROUP_ID=sg-xxxxx

# ── Deployment Behavior ─────────────────────────────────────
# IMAGE_TAG defaults to current git short SHA.
# IMAGE_TAG=
# Keep immutable tags authoritative. Set true only if you intentionally need latest.
# PUSH_LATEST=false
# COLLECTOR_DESIRED_COUNT=1
# ANALYSIS_DESIRED_COUNT=0
# VOD_COLLECTOR_DESIRED_COUNT=0

# ── EventBridge Schedules ───────────────────────────────────
# ANALYSIS_SCHEDULE=cron(0 3 * * ? *)
# VOD_SCHEDULE=rate(6 hours)
# ANALYSIS_RULE_NAME=vieweratlas-analysis-daily
# VOD_RULE_NAME=vieweratlas-vod-6h

# ── Smoke Test / Monitoring ─────────────────────────────────
# S3_FRESHNESS_MAX_AGE_MINUTES=180
# SNS_TOPIC_ARN=arn:aws:sns:us-east-1:123456789012:vieweratlas-alerts
