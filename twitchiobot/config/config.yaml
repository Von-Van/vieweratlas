# ViewerAtlas Pipeline Configuration
# Save this file and reference it: python main.py analyze config.yaml
# Environment variables override these settings

# ============================================
# Storage Configuration
# ============================================
# Options: 'file' (local filesystem) or 's3' (AWS S3)
storage_type: "file"

# S3 Settings (required if storage_type='s3')
# s3_bucket: "vieweratlas-data-lake"
# s3_prefix: "vieweratlas/"
# s3_region: "us-east-1"

# Environment variables for S3:
# export STORAGE_TYPE=s3
# export S3_BUCKET=your-bucket-name
# export S3_PREFIX=vieweratlas/
# export AWS_PROFILE=your-profile  # or use AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY

collection:
  # Directory for log files (JSON snapshots + CSV chatter logs)
  logs_dir: "logs"
  
  # How often to collect data (seconds)
  collection_interval: 3600  # 1 hour
  
analysis:
  # Minimum viewers to count as overlap (edges with fewer are removed)
  overlap_threshold: 1
  
  # Minimum size of communities to report
  min_community_size: 2
  
  # Resolution parameter for Louvain algorithm
  # Higher = more communities, Lower = fewer communities
  resolution: 1.0
  
  # Game name threshold (%) for automatic tagging
  game_threshold: 60
  
  # Language threshold (%) for automatic tagging
  language_threshold: 40
  
  # Directory for analysis outputs
  output_dir: "community_analysis"
  
  # Directory for log files
  logs_dir: "logs"

# ============================================
# VOD (Video On Demand) Collection
# ============================================
# Optional: Supplement live data with historical VOD chat replay
vod:
  # Enable VOD collection (requires TwitchDownloaderCLI)
  enabled: false
  
  # Time bucket window in seconds (should match live collection)
  bucket_len_s: 60
  
  # Directory for raw VOD chat JSON files
  raw_dir: "vod_raw"
  
  # VOD processing queue file
  queue_file: "vod_queue.json"
  
  # Path to TwitchDownloaderCLI executable
  # Download from: https://github.com/lay295/TwitchDownloader
  cli_path: "TwitchDownloaderCLI"
  
  # Automatically discover recent VODs for channels in channels.txt
  auto_discover: false
  
  # Number of recent VODs to queue per channel (max 100)
  vod_limit_per_channel: 5
  
  # Maximum VOD age in days (prevents processing very old VODs)
  max_age_days: 14
  
  # Minimum view count filter (0 = no filter)
  min_views: 0

# Usage:
#  1. Manual VOD queueing:
#     python vod_collector.py add --vod-id 1234567890 --channel xqc
#
#  2. Auto-discovery from channels.txt:
#     python vod_collector.py discover --channels-file channels.txt --vod-limit 5
#
#  3. Process queue:
#     python vod_collector.py process
#
#  4. Check queue status:
#     python vod_collector.py stats

# ============================================
# Logging Configuration
# ============================================
log_level: "INFO"
log_format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# ============================================
# Preset configurations (uncomment to use)
# ============================================

# RIGOROUS MODE: TwitchAtlas-style filtering
# rigorous:
#   collection:
#     collection_interval: 3600
#   analysis:
#     overlap_threshold: 300      # High threshold for strong overlaps
#     min_community_size: 10      # Larger communities only
#     resolution: 0.8             # Fewer, larger communities
#     game_threshold: 70
#     language_threshold: 50
#   log_level: "INFO"

# EXPLORATORY MODE: Fine-grained communities
# explorer:
#   analysis:
#     overlap_threshold: 1
#     min_community_size: 2
#     resolution: 2.0             # Many small communities
#     game_threshold: 50
#     language_threshold: 30
#   log_level: "DEBUG"

# DEBUG MODE: Small dataset, verbose logging
# debug:
#   collection:
#     collection_interval: 60     # Collect every minute
#   analysis:
#     overlap_threshold: 1
#     output_dir: "community_analysis_debug"
#   log_level: "DEBUG"
